# Exploitation Tactics — Exploit Selection & Execution

## Exploit Selection Priority

```
PREFER (in order):
  1. Known exploit with exact version match  → highest success rate
  2. Default/weak credentials                → zero noise
  3. SQL injection                           → data + possible RCE
  4. File upload bypass                      → direct shell
  5. LFI → log poisoning → RCE              → multi-step but reliable
  6. Auth bypass                             → access escalation
  7. Brute force credentials                 → LAST RESORT

AVOID:
  - DoS exploits (prove access, not disruption)
  - Kernel exploits for initial access (save for privesc)
  - Client-side attacks unless specifically relevant
```

## Pre-Exploitation Checklist

```
BEFORE RUNNING ANY EXPLOIT:
  □ Target is in scope
  □ Service version confirmed (not assumed)
  □ Exploit matches version
  □ Exploit code reviewed (no backdoors, correct payload)
  □ Understand what the exploit does
  □ Know the expected outcome
  □ Have fallback if it fails
```

## Common Attack Patterns

### Web Shell Upload

```
FOUND FILE UPLOAD?
  1. Upload normal file → confirm it works
  2. Upload .php shell → if accepted, navigate to it
  3. If blocked:
     ├─ Change extension: .php5, .phtml, .phar, .php.jpg
     ├─ Change content-type: image/jpeg
     ├─ Add magic bytes: GIF89a before PHP code
     ├─ Null byte: shell.php%00.jpg (legacy)
     └─ Double extension: shell.php.jpg (misconfigured)
  4. Find upload path (check response, gobuster)
  5. Navigate to shell → RCE
```

### SQL Injection Manual Steps

```
SUSPECTED SQLi:
  1. Test: ' → error? Different response?
  2. Test: ' OR 1=1-- → all results?
  3. Test: ' UNION SELECT NULL-- → column count
  4. If confirmed → use sqlmap for extraction
  5. sqlmap --os-shell if DB user has FILE privilege
```

### LFI to RCE

```
LFI CONFIRMED (can read /etc/passwd):
  1. Read /etc/passwd → user list
  2. Read /proc/self/environ → possible info
  3. Read access.log path → then poison with PHP in User-Agent
  4. Read /var/mail/<user> → if writable, send PHP via SMTP
  5. PHP wrappers: php://filter/convert.base64-encode/resource=
  6. PHP input: php://input with POST body = PHP code
```

### Credential Reuse Pattern

```
CREDS FOUND ON SERVICE A:
  → Try on SSH (priority: gives shell)
  → Try on FTP
  → Try on SMB
  → Try on web login
  → Try on database
  → Try on RDP/VNC
  → Try variations: same password + different users
  → Try: same user + common password mutations
```

## Post-Exploitation Immediate Actions

```
SHELL OBTAINED:
  1. whoami               → what user?
  2. id                   → groups?
  3. uname -a             → kernel version (privesc?)
  4. cat /etc/passwd      → other users
  5. sudo -l              → sudo permissions
  6. find / -perm -4000   → SUID binaries
  7. ls -la /home/        → other user directories
  8. cat /etc/crontab     → scheduled tasks
  9. netstat -tlnp        → internal services
  10. env                 → environment variables (creds?)
```

## Exploit Failure Response

```
EXPLOIT DIDN'T WORK:
  ├─ Version mismatch?     → verify exact version again
  ├─ Patched?              → check patch date vs exploit date
  ├─ WAF blocking?         → try encoding, alternative payload
  ├─ Wrong parameters?     → re-read exploit usage
  ├─ Network issue?        → can you reach the service?
  └─ Move on              → don't brute-force a dead end
```
